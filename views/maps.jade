doctype html
html
    head
        meta(charset="utf-8")
        title FOS
        style.
            html, body, #map-canvas {
                height: 100%;
                margin: 0px;
                padding: 0px
            }
            #panel {
                position: absolute;
                top: 5px;
                left: 50%;
                margin-left: -180px;
                z-index: 5;
                background-color: #fff;
                padding: 5px;
                border: 1px solid #999;
            }

        script(type='text/javascript' src='/javascripts/pin.js')
        script(src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCJIlUHgkbX3pUv7guWvW4E6eqg_DlpaP0")
        script.

            var pins = JSON.parse('!{collections.pins}');
            var pin = new Pin("kkss", "asas", "asa", "asasa");
            console.log(pin.toString());

            var centerlatitude = 0.0;
            var centerlongitude = 0.0;

            var H_Lat = -91;
            var L_Lat = 91;
            var H_Long = -181
            var L_Long = 181;

            pins.forEach(function(pin){
                if (pin.Latitude > H_Lat && pin.Latitude != null) {
                    H_Lat = pin.Latitude;
                }

                if (pin.Latitude < L_Lat && pin.Latitude != null){
                    L_Lat = pin.Latitude;
                }

                if (pin.Longitude > H_Long && pin.Longitude != null){
                    H_Long = pin.Longitude;
                }

                if (pin.Longitude < L_Long && pin.Longitude != null) {
                    L_Long = pin.Longitude;
                }

            });

            console.log("HLat: " + String(H_Lat) + " \ LLat: " + String(L_Lat));
            console.log("HLong: " + String(H_Long) + " \ LLong: " + String(L_Long));

            centerlatitude = (H_Lat + L_Lat)/2;
            centerlongitude = (H_Long + L_Long)/2;

            console.log("Lat: " + String(centerlatitude) + " / " + "Long: " + String(centerlongitude));

            var map;

            var center = new google.maps.LatLng(centerlatitude, centerlongitude);

            var rectangle = new google.maps.Polygon({
                paths: [
                    new google.maps.LatLng(H_Lat, H_Long),
                    new google.maps.LatLng(L_Lat, H_Long),
                    new google.maps.LatLng(L_Lat, L_Long),
                    new google.maps.LatLng(H_Lat, L_Long)
                ]
            });

            function initialize() {
                var mapOptions = {
                    zoom: 15,
                    center: center,
                    disableDefaultUI: true,
                    mapTypeId: 'satellite',
                    draggable: true
                };
                map = new google.maps.Map(document.getElementById('map-canvas'),
                    mapOptions);

                placeMarker(center, map);

                google.maps.event.addListener(map, 'click', function (e) {
                    console.log(e.latLng);
                    placeMarker(e.latLng, map);
                });

                rectangle.setMap(map);
            }

            function addPin(Pin){
                console.log("Pin:" + String(Pin.Latitude) + " - " + String(Pin.Longitude));
                var location = new google.maps.LatLng(Pin.Latitude, Pin.Longitude);
                var circle = new google.maps.Circle({
                    strokeColor: '#FF0000',
                    strokeOpacity: 0.8,
                    strokeWeight: 2,
                    fillColor: '#FF0000',
                    fillOpacity: 0.35,
                    map: map,
                    center: location,
                    radius: 3
                });
                circle.setMap(map);

            }

            function placeMarker(position, map) {
                var marker = new google.maps.Marker({
                    position: position,
                    map: map
                });
            }



            google.maps.event.addDomListener(window, 'load', initialize);

            window.onbeforeunload = function(){ window.scrollTo(0,0) };

        script(src='https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js')
        link(rel='stylesheet',
        href='https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css',
        integrity='sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ',
        crossorigin='anonymous')
        script(src='https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js',
        integrity='sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn',
        crossorigin='anonymous')
    style.
        body{
            overflow: hidden;
        }

block body
        script.
            var plotMyShit = function () {
                pins.forEach(function(pin){
                    addPin(pin);
                });
            }

        nav.navbar.navbar-toggleable-md.navbar-inverse.bg-primary
            button.navbar-toggler.navbar-toggler-right(type='button',
            data-toggle='collapse',
            data-target='#navbarSupportedContent',
            aria-controls='navbarSupportedContent',
            aria-expanded='false',
            aria-label='Toggle navigation')
                span.navbar-toggler-icon

            a.navbar-brand(href='#') FOS
            #navbarSupportedContent.collapse.navbar-collapse
                ul.navbar-nav.mr-auto
                    li.nav-item
                        #plotPoints
                        a.nav-link(href="#", onclick='plotMyShit()') Plot

        #map-canvas